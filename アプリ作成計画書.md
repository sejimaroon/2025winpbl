プロジェクト: クリニック業務引き継ぎ・日報アプリ開発計画書
1. プロジェクト概要
クリニックスタッフ（医師、看護師、事務など）が使用する、モバイルファーストの業務引き継ぎ・日報共有Webアプリケーション。
アジャイル開発を採用し、まずはPhase 1 (MVP) の実装を目指す。
2. 技術スタック (Tech Stack)
以下の技術選定を厳守すること。
Frontend: Next.js 14+ (App Router), TypeScript, Tailwind CSS
UI Library: Lucide React (アイコン), shadcn/ui (必要に応じて)
Backend/DB: Supabase (PostgreSQL, Auth, Realtime)
Deployment: Vercel
3. データベース設計
詳細は別添の database_schema.md (Mermaid図) を参照のこと。
Supabaseにてこのスキーマ通りにテーブルを作成する前提で実装する。
重要なテーブル構造のポイント:
DIARY: 日報の本体。target_date で日付を管理。
USER_DIARY_STATUS: 各ユーザーの既読・作業状態（イニシャル表示用）。
ACTION_LOG: 行動履歴。ポイント付与のトリガーとなる。
POINT_LOG: ポイントの履歴。
4. UI/UX設計 (Wireframe Mapping)
手書きワイヤーフレームに基づき、以下のUIコンポーネントを実装する。
A. グローバルレイアウト (Layout)
Header:
左: タイトルロゴ
右: ユーザー設定アイコン、現在の所持ポイント表示 (例: ♡ 120)
フィルタボタン（Phase 2実装予定だが、配置はしておく）: [至急] [やることリスト]
B. トップページ (Daily Timeline)
日付ナビゲーション:
YYYY年MM月DD日 < 前日 > < 翌日 > の形式で表示。
選択された日付の DIARY データを取得して表示する。
日報カード (Diary Card):
縦にタイムライン形式で並ぶ。
ヘッダー: タイトル、カテゴリラベル（色付きバッジ）、投稿者名、時刻。
本文: テキスト表示。
アクションエリア:
[確認] [作業中] [返信] [解決] の4ボタンを配置。
ステータス表示: ボタンの下に、そのステータスにあるユーザーのイニシャルを丸アイコンで列挙する（例: 🟢(鈴) 🔵(田) ）。
投稿ボタン (Floating Action Button):
画面右下に固定配置。クリックすると投稿モーダルまたはページが開く。
5. 機能要件 (Phase 1: MVP)
このフェーズでは「全員が投稿・確認できる」ことを最優先する。
1. 認証 (Auth)
Supabase Authを使用（Email/Password）。
ログインしていないユーザーは /login へリダイレクト。
初期ユーザーデータ (STAFF テーブル) との紐付けを考慮する。
2. 日報一覧表示 (Read)
Server Componentsを使用し、target_date に基づいて DIARY を取得。
同時に、各DIARYに関連する USER_DIARY_STATUS を取得し、イニシャル表示用に整形する。
3. 日報投稿 (Create)
必須項目: category_id, title, content, target_date.
投稿者はログインユーザー (staff_id) を自動設定。
is_urgent (至急フラグ) のON/OFFスイッチ実装。
4. ステータス更新アクション (Update)
「確認」などのボタン押下時の処理（Server Actions推奨）。
トランザクション的な処理:
ACTION_LOG に履歴を追加（例: action_type: 'CONFIRM', points: 1）。
POINT_LOG にポイント履歴を追加。
STAFF の current_points を加算。
USER_DIARY_STATUS を CONFIRMED に更新（Upsert）。
処理完了後、revalidatePath で画面を更新し、自分のイニシャルが即座に反映されるようにする。
6. 開発ステップ (Implementation Steps)
AIはこの順序でコードを生成すること。
Project Setup: Next.js + Tailwind CSS の初期化、Supabaseクライアントの設定。
Types Database: SupabaseのスキーマからTypeScriptの型定義を生成/定義。
Components: UIパーツ (DiaryCard, DateNavigator, StatusBadge) の作成。
Features (Read): トップページでのデータ取得と表示ロジックの実装。
Features (Write): 新規投稿機能の実装。
Features (Action): ステータスボタン押下時のバックエンドロジック実装。
7. デザインガイドライン
Tailwind CSS を使用。
Mobile First: スマホでの操作性を最優先（ボタンの大きさ、タップ領域）。
Color Scheme: 医療現場向けに、清潔感のある白ベース＋カテゴリごとの視認しやすいアクセントカラーを使用。
指示:
まずはプロジェクトのディレクトリ構造と、Supabase接続用の環境変数設定、および主要な型定義（Types）のコードから提示してください。
